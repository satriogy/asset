
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asset Management System - Enterprise</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Custom Styles -->
    <style>
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .slide-in { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        
        .chart-container { position: relative; height: 300px; }
        
        .scrollbar-thin::-webkit-scrollbar { width: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 3px; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #888; border-radius: 3px; }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover { background: #555; }
        
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .btn-primary:hover { background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100% ); }
        
        .dark { background: #1a1a1a; color: #ffffff; }
        .dark .bg-white { background: #2d2d2d; }
        .dark .bg-gray-50 { background: #252525; }
        .dark .text-gray-900 { color: #ffffff; }
        .dark .text-gray-600 { color: #a0a0a0; }
        .dark .border-gray-200 { border-color: #404040; }
        
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; }
        
        .status-badge { 
            display: inline-flex; 
            align-items: center; 
            gap: 0.25rem; 
            padding: 0.25rem 0.75rem; 
            border-radius: 9999px; 
            font-size: 0.75rem; 
            font-weight: 500; 
        }
        
        .kpi-card { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 1.5rem; 
            border-radius: 1rem; 
            position: relative; 
            overflow: hidden; 
        }
        
        .kpi-card::before { 
            content: ''; 
            position: absolute; 
            top: 0; 
            right: 0; 
            width: 100px; 
            height: 100px; 
            background: rgba(255,255,255,0.1); 
            border-radius: 50%; 
            transform: translate(30px, -30px); 
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
        }

        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: #10b981;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 2000;
            display: none;
        }

        .toast.show {
            display: block;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-card {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .mobile-menu {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 999;
            padding: 1rem;
        }

        .mobile-menu.show {
            display: block;
        }

        @media (max-width: 768px) {
            .mobile-menu {
                display: none;
            }
            
            .mobile-menu.show {
                display: block;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Login Page -->
    <div id="login-page" class="login-container">
        <div class="login-card">
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i data-lucide="package" class="w-8 h-8 text-white"></i>
                </div>
                <h1 class="text-2xl font-bold text-gray-900">Asset Management</h1>
                <p class="text-gray-600 mt-2">Sign in to your account</p>
            </div>
            
            <form id="login-form" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                </div>
                
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                </div>
                
                <button type="submit" class="btn-primary text-white px-4 py-2 rounded-lg w-full">Sign In</button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-sm text-gray-600">
                    Don't have an account? 
                    <button onclick="showRegisterForm()" class="text-indigo-600 hover:text-indigo-800 font-medium">Sign up</button>
                </p>
            </div>
            
            <div class="mt-4 text-center">
                <p class="text-xs text-gray-500">Demo: admin@company.com / admin123</p>
            </div>
        </div>
    </div>

    <!-- Register Form (Hidden by default) -->
    <div id="register-form" class="hidden">
        <div class="text-center mb-8">
            <h2 class="text-2xl font-bold text-gray-900">Create Account</h2>
            <p class="text-gray-600 mt-2">Sign up to get started</p>
        </div>
        
        <form onsubmit="handleRegister(event)">
            <div class="form-group">
                <label for="register-name">Full Name</label>
                <input type="text" id="register-name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
            </div>
            
            <div class="form-group">
                <label for="register-email">Email</label>
                <input type="email" id="register-email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
            </div>
            
            <div class="form-group">
                <label for="register-password">Password</label>
                <input type="password" id="register-password" required minlength="6" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
            </div>
            
            <div class="form-group">
                <label for="register-role">Role</label>
                <select id="register-role" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                    <option value="">Select Role</option>
                    <option value="Administrator">Administrator</option>
                    <option value="Manager">Manager</option>
                    <option value="Staff">Staff</option>
                    <option value="Viewer">Viewer</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="register-department">Department</label>
                <input type="text" id="register-department" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
            </div>
            
            <button type="submit" class="btn-primary text-white px-4 py-2 rounded-lg w-full">Sign Up</button>
        </form>
        
        <div class="mt-6 text-center">
            <p class="text-sm text-gray-600">
                Already have an account? 
                <button onclick="showLoginForm()" class="text-indigo-600 hover:text-indigo-800 font-medium">Sign in</button>
            </p>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app" class="min-h-screen flex flex-col hidden">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex items-center">
                        <i data-lucide="package" class="w-8 h-8 text-indigo-600 mr-3"></i>
                        <h1 class="text-xl font-bold text-gray-900">Asset Management System</h1>
                    </div>
                    
                    <!-- Desktop Navigation -->
                    <nav class="hidden md:flex space-x-8">
                        <button onclick="showPage('dashboard')" class="nav-btn text-indigo-600 px-3 py-2 text-sm font-medium">Dashboard</button>
                        <button onclick="showPage('assets')" class="nav-btn text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium">Assets</button>
                        <button onclick="showPage('maintenance')" class="nav-btn text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium">Maintenance</button>
                        <button onclick="showPage('reports')" class="nav-btn text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium">Reports</button>
                        <button onclick="showPage('users')" class="nav-btn text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium">Users</button>
                        <button onclick="showPage('licenses')" class="nav-btn text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium">Licenses</button>
                        <button onclick="showPage('settings')" class="nav-btn text-gray-700 hover:text-indigo-600 px-3 py-2 text-sm font-medium">Settings</button>
                    </nav>
                    
                    <div class="flex items-center space-x-4">
                        <button onclick="toggleDarkMode()" class="p-2 rounded-md hover:bg-gray-100">
                            <i data-lucide="moon" class="w-5 h-5 text-gray-600"></i>
                        </button>
                        <div class="relative">
                            <button onclick="toggleNotifications()" class="p-2 rounded-md hover:bg-gray-100">
                                <i data-lucide="bell" class="w-5 h-5 text-gray-600"></i>
                                <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"></span>
                            </button>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-indigo-600 rounded-full flex items-center justify-center">
                                <span id="user-initials" class="text-white text-sm font-medium">A</span>
                            </div>
                            <span id="user-name" class="text-sm font-medium text-gray-700">Admin User</span>
                            <button onclick="handleLogout()" class="text-red-600 hover:text-red-800 text-sm">Logout</button>
                        </div>
                        
                        <!-- Mobile Menu Button -->
                        <button onclick="toggleMobileMenu()" class="md:hidden p-2 rounded-md hover:bg-gray-100">
                            <i data-lucide="menu" class="w-5 h-5 text-gray-600"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="mobile-menu">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold">Menu</h2>
                <button onclick="toggleMobileMenu()" class="p-2 rounded-md hover:bg-gray-100">
                    <i data-lucide="x" class="w-5 h-5 text-gray-600"></i>
                </button>
            </div>
            <nav class="space-y-2">
                <button onclick="showPage('dashboard'); toggleMobileMenu();" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 rounded">Dashboard</button>
                <button onclick="showPage('assets'); toggleMobileMenu();" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 rounded">Assets</button>
                <button onclick="showPage('maintenance'); toggleMobileMenu();" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 rounded">Maintenance</button>
                <button onclick="showPage('reports'); toggleMobileMenu();" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 rounded">Reports</button>
                <button onclick="showPage('users'); toggleMobileMenu();" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 rounded">Users</button>
                <button onclick="showPage('licenses'); toggleMobileMenu();" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 rounded">Licenses</button>
                <button onclick="showPage('settings'); toggleMobileMenu();" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 rounded">Settings</button>
            </nav>
        </div>

        <!-- Main Content -->
        <main class="flex-1 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Dashboard Page -->
            <div id="dashboard-page" class="page fade-in">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-900">Dashboard</h2>
                    <p class="text-gray-600 mt-2">Selamat datang kembali! Berikut overview sistem manajemen aset Anda.</p>
                </div>

                <!-- KPI Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="kpi-card card-hover">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/80 text-sm">Total Assets</p>
                                <p class="text-3xl font-bold mt-1" id="total-assets">0</p>
                                <p class="text-white/70 text-sm mt-2">+12% dari bulan lalu</p>
                            </div>
                            <i data-lucide="package" class="w-12 h-12 text-white/50"></i>
                        </div>
                    </div>
                    
                    <div class="kpi-card card-hover" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/80 text-sm">Active Assets</p>
                                <p class="text-3xl font-bold mt-1" id="active-assets">0</p>
                                <p class="text-white/70 text-sm mt-2" id="utilization-rate">0% utilization</p>
                            </div>
                            <i data-lucide="activity" class="w-12 h-12 text-white/50"></i>
                        </div>
                    </div>
                    
                    <div class="kpi-card card-hover" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/80 text-sm">Maintenance</p>
                                <p class="text-3xl font-bold mt-1" id="maintenance-count">0</p>
                                <p class="text-white/70 text-sm mt-2">Terjadwal bulan ini</p>
                            </div>
                            <i data-lucide="wrench" class="w-12 h-12 text-white/50"></i>
                        </div>
                    </div>
                    
                    <div class="kpi-card card-hover" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/80 text-sm">Health Score</p>
                                <p class="text-3xl font-bold mt-1">94%</p>
                                <p class="text-white/70 text-sm mt-2">Kondisi excellent</p>
                            </div>
                            <i data-lucide="trending-up" class="w-12 h-12 text-white/50"></i>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8">
                    <h3 class="text-lg font-semibold mb-4">Quick Actions</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <button onclick="showPage('assets'); setTimeout(() => openAddAssetModal(), 100);" class="flex items-center justify-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                            <i data-lucide="plus" class="w-5 h-5"></i>
                            <span>Tambah Aset Baru</span>
                        </button>
                        <button onclick="showPage('maintenance'); setTimeout(() => openScheduleMaintenanceModal(), 100);" class="flex items-center justify-center space-x-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700">
                            <i data-lucide="calendar" class="w-5 h-5"></i>
                            <span>Jadwalkan Maintenance</span>
                        </button>
                        <button onclick="showPage('reports');" class="flex items-center justify-center space-x-2 px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                            <i data-lucide="file-text" class="w-5 h-5"></i>
                            <span>Generate Laporan</span>
                        </button>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <h3 class="text-lg font-semibold mb-4">Distribusi Aset</h3>
                        <div class="chart-container">
                            <canvas id="assetChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <h3 class="text-lg font-semibold mb-4">Overview Maintenance</h3>
                        <div class="chart-container">
                            <canvas id="maintenanceChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="p-6 border-b border-gray-200">
                        <h3 class="text-lg font-semibold">Aktivitas Terbaru</h3>
                    </div>
                    <div class="p-6 space-y-4 max-h-96 overflow-y-auto scrollbar-thin" id="recent-activity">
                        <!-- Activity items will be dynamically added here -->
                    </div>
                </div>
            </div>

            <!-- Assets Page -->
            <div id="assets-page" class="page hidden">
                <div class="mb-8 flex justify-between items-center">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900">Asset Management</h2>
                        <p class="text-gray-600">Kelola dan lacak semua aset perusahaan</p>
                    </div>
                    <button onclick="openAddAssetModal()" class="btn-primary text-white px-4 py-2 rounded-lg hover:opacity-90 transition-opacity flex items-center space-x-2">
                        <i data-lucide="plus" class="w-4 h-4"></i>
                        <span>Add Asset</span>
                    </button>
                </div>

                <!-- Filters -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 mb-6">
                    <div class="flex flex-wrap gap-4 items-center">
                        <div class="flex-1 min-w-64">
                            <div class="relative">
                                <i data-lucide="search" class="w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                <input type="text" id="asset-search" placeholder="Search assets..." onkeyup="filterAssets()" class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            </div>
                        </div>
                        <select id="category-filter" onchange="filterAssets()" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                            <option value="">All Categories</option>
                            <option value="Electronics">Electronics</option>
                            <option value="Furniture">Furniture</option>
                            <option value="Vehicle">Vehicle</option>
                            <option value="Equipment">Equipment</option>
                        </select>
                        <select id="status-filter" onchange="filterAssets()" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                            <option value="">All Status</option>
                            <option value="Active">Active</option>
                            <option value="Maintenance">Maintenance</option>
                            <option value="Retired">Retired</option>
                        </select>
                        <button onclick="exportAssets()" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center space-x-2">
                            <i data-lucide="download" class="w-4 h-4"></i>
                            <span>Export</span>
                        </button>
                    </div>
                </div>

                <!-- Assets Table -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Asset</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Value</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Purchase Date</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200" id="assets-table-body">
                                <!-- Asset rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Licenses Page -->
            <div id="licenses-page" class="page hidden">
                <div class="mb-8 flex justify-between items-center">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900">License Management</h2>
                        <p class="text-gray-600">Kelola lisensi software dan subscription</p>
                    </div>
                    <button onclick="openAddLicenseModal()" class="btn-primary text-white px-4 py-2 rounded-lg hover:opacity-90 transition-opacity flex items-center space-x-2">
                        <i data-lucide="plus" class="w-4 h-4"></i>
                        <span>Add License</span>
                    </button>
                </div>

                <!-- License Stats -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                                <i data-lucide="shield" class="w-6 h-6 text-blue-600"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">Total Licenses</p>
                                <p class="text-2xl font-bold text-gray-900" id="total-licenses">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mr-4">
                                <i data-lucide="check-circle" class="w-6 h-6 text-green-600"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">Active</p>
                                <p class="text-2xl font-bold text-gray-900" id="active-licenses">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center mr-4">
                                <i data-lucide="alert-circle" class="w-6 h-6 text-red-600"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">Expiring Soon</p>
                                <p class="text-2xl font-bold text-gray-900" id="expiring-licenses">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Licenses Table -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Software</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">License Key</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Seats</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Used</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Expiry Date</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200" id="licenses-table-body">
                                <!-- License rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Other pages (Maintenance, Reports, Users, Settings) remain the same -->
            <!-- ... (keeping the existing code for other pages) ... -->
        </main>

        <!-- Footer -->
        <footer class="bg-white border-t border-gray-200 mt-auto">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <div class="flex justify-between items-center">
                    <p class="text-gray-500 text-sm">Â© 2024 Asset Management System. All rights reserved.</p>
                    <div class="flex space-x-6">
                        <a href="#" class="text-gray-500 hover:text-gray-700 text-sm">Help</a>
                        <a href="#" class="text-gray-500 hover:text-gray-700 text-sm">Privacy</a>
                        <a href="#" class="text-gray-500 hover:text-gray-700 text-sm">Terms</a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Add Asset Modal -->
    <div id="add-asset-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold" id="asset-modal-title">Add New Asset</h3>
                <button onclick="closeModal('add-asset-modal')" class="text-gray-500 hover:text-gray-700">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            
            <form id="add-asset-form" onsubmit="saveAsset(event)">
                <input type="hidden" id="asset-id" name="asset-id">
                
                <div class="form-group">
                    <label for="asset-name">Asset Name *</label>
                    <input type="text" id="asset-name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="form-group">
                    <label for="asset-category">Category *</label>
                    <select id="asset-category" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        <option value="">Select Category</option>
                        <option value="Electronics">Electronics</option>
                        <option value="Furniture">Furniture</option>
                        <option value="Vehicle">Vehicle</option>
                        <option value="Equipment">Equipment</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="asset-status">Status *</label>
                    <select id="asset-status" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        <option value="Active">Active</option>
                        <option value="Maintenance">Maintenance</option>
                        <option value="Retired">Retired</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="asset-location">Location *</label>
                    <input type="text" id="asset-location" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="form-group">
                    <label for="asset-value">Value (IDR) *</label>
                    <input type="number" id="asset-value" required min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="form-group">
                    <label for="asset-purchase-date">Purchase Date *</label>
                    <input type="date" id="asset-purchase-date" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="form-group">
                    <label for="asset-description">Description</label>
                    <textarea id="asset-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg"></textarea>
                </div>
                
                <div class="flex space-x-3">
                    <button type="submit" class="btn-primary text-white px-4 py-2 rounded-lg flex-1" id="asset-submit-btn">Save Asset</button>
                    <button type="button" onclick="closeModal('add-asset-modal')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex-1">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add License Modal -->
    <div id="add-license-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold" id="license-modal-title">Add New License</h3>
                <button onclick="closeModal('add-license-modal')" class="text-gray-500 hover:text-gray-700">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            
            <form id="add-license-form" onsubmit="saveLicense(event)">
                <input type="hidden" id="license-id" name="license-id">
                
                <div class="form-group">
                    <label for="license-software">Software Name *</label>
                    <input type="text" id="license-software" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="form-group">
                    <label for="license-key">License Key *</label>
                    <input type="text" id="license-key" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="form-group">
                    <label for="license-type">License Type *</label>
                    <select id="license-type" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        <option value="">Select Type</option>
                        <option value="Perpetual">Perpetual</option>
                        <option value="Subscription">Subscription</option>
                        <option value="Trial">Trial</option>
                        <option value="Open Source">Open Source</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="license-seats">Number of Seats *</label>
                    <input type="number" id="license-seats" required min="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="form-group">
                    <label for="license-used">Seats Used</label>
                    <input type="number" id="license-used" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="form-group">
                    <label for="license-expiry">Expiry Date</label>
                    <input type="date" id="license-expiry" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="form-group">
                    <label for="license-vendor">Vendor</label>
                    <input type="text" id="license-vendor" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                
                <div class="form-group">
                    <label for="license-description">Description</label>
                    <textarea id="license-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg"></textarea>
                </div>
                
                <div class="flex space-x-3">
                    <button type="submit" class="btn-primary text-white px-4 py-2 rounded-lg flex-1" id="license-submit-btn">Save License</button>
                    <button type="button" onclick="closeModal('add-license-modal')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex-1">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <span id="toast-message"></span>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Database Manager
        class DatabaseManager {
            constructor() {
                this.initializeDatabase();
            }

            initializeDatabase() {
                if (!localStorage.getItem('assets')) {
                    localStorage.setItem('assets', JSON.stringify(this.getSampleAssets()));
                }
                if (!localStorage.getItem('users')) {
                    localStorage.setItem('users', JSON.stringify(this.getSampleUsers()));
                }
                if (!localStorage.getItem('licenses')) {
                    localStorage.setItem('licenses', JSON.stringify(this.getSampleLicenses()));
                }
                if (!localStorage.getItem('activities')) {
                    localStorage.setItem('activities', JSON.stringify([]));
                }
                if (!localStorage.getItem('settings')) {
                    localStorage.setItem('settings', JSON.stringify(this.getSampleSettings()));
                }
            }

            getSampleAssets() {
                return [
                    {
                        id: 'AST001',
                        name: 'Laptop Dell XPS 15',
                        category: 'Electronics',
                        status: 'Active',
                        location: 'Office A',
                        value: 24990000,
                        purchaseDate: '2024-01-15',
                        description: 'High-performance laptop for development team'
                    },
                    {
                        id: 'AST002',
                        name: 'Company Vehicle - Toyota Avanza',
                        category: 'Vehicle',
                        status: 'Active',
                        location: 'Parking Lot',
                        value: 250000000,
                        purchaseDate: '2023-06-20',
                        description: 'Company vehicle for operations'
                    },
                    {
                        id: 'AST003',
                        name: 'Office Desk Ergonomic',
                        category: 'Furniture',
                        status: 'Active',
                        location: 'Office B',
                        value: 3500000,
                        purchaseDate: '2023-12-10',
                        description: 'Ergonomic office desk'
                    }
                ];
            }

            getSampleUsers() {
                return [
                    {
                        id: 'USR001',
                        name: 'Admin User',
                        email: 'admin@company.com',
                        password: 'admin123',
                        role: 'Administrator',
                        department: 'IT',
                        status: 'Active',
                        lastActive: new Date().toISOString()
                    },
                    {
                        id: 'USR002',
                        name: 'John Manager',
                        email: 'john@company.com',
                        password: 'manager123',
                        role: 'Manager',
                        department: 'Operations',
                        status: 'Active',
                        lastActive: new Date(Date.now() - 3600000).toISOString()
                    }
                ];
            }

            getSampleLicenses() {
                return [
                    {
                        id: 'LIC001',
                        software: 'Microsoft Office 365',
                        licenseKey: 'XXXX-XXXX-XXXX-XXXX',
                        type: 'Subscription',
                        seats: 50,
                        used: 35,
                        expiryDate: '2024-12-31',
                        vendor: 'Microsoft',
                        description: 'Productivity suite for all employees'
                    },
                    {
                        id: 'LIC002',
                        software: 'Adobe Creative Cloud',
                        licenseKey: 'YYYY-YYYY-YYYY-YYYY',
                        type: 'Subscription',
                        seats: 10,
                        used: 8,
                        expiryDate: '2024-06-30',
                        vendor: 'Adobe',
                        description: 'Design software for creative team'
                    }
                ];
            }

            getSampleSettings() {
                return {
                    companyName: 'PT. Asset Management Indonesia',
                    defaultCurrency: 'IDR',
                    dateFormat: 'DD/MM/YYYY'
                };
            }

            // Users
            getUsers() {
                return JSON.parse(localStorage.getItem('users') || '[]');
            }

            saveUser(user) {
                const users = this.getUsers();
                user.id = user.id || 'USR' + Date.now().toString().slice(-6);
                user.createdAt = user.createdAt || new Date().toISOString();
                
                const existingIndex = users.findIndex(u => u.id === user.id);
                if (existingIndex >= 0) {
                    users[existingIndex] = { ...users[existingIndex], ...user, updatedAt: new Date().toISOString() };
                } else {
                    users.push(user);
                }
                
                localStorage.setItem('users', JSON.stringify(users));
                return user;
            }

            // Assets
            getAssets() {
                return JSON.parse(localStorage.getItem('assets') || '[]');
            }

            saveAsset(asset) {
                const assets = this.getAssets();
                asset.id = asset.id || 'AST' + Date.now().toString().slice(-6);
                asset.createdAt = asset.createdAt || new Date().toISOString();
                
                const existingIndex = assets.findIndex(a => a.id === asset.id);
                if (existingIndex >= 0) {
                    assets[existingIndex] = { ...assets[existingIndex], ...asset, updatedAt: new Date().toISOString() };
                } else {
                    assets.push(asset);
                }
                
                localStorage.setItem('assets', JSON.stringify(assets));
                this.addActivity(`Asset ${asset.name} ${existingIndex >= 0 ? 'updated' : 'added'}`, 'asset');
                return asset;
            }

            deleteAsset(assetId) {
                const assets = this.getAssets();
                const asset = assets.find(a => a.id === assetId);
                const filtered = assets.filter(a => a.id !== assetId);
                localStorage.setItem('assets', JSON.stringify(filtered));
                this.addActivity(`Asset ${asset.name} deleted`, 'asset');
            }

            // Licenses
            getLicenses() {
                return JSON.parse(localStorage.getItem('licenses') || '[]');
            }

            saveLicense(license) {
                const licenses = this.getLicenses();
                license.id = license.id || 'LIC' + Date.now().toString().slice(-6);
                license.createdAt = license.createdAt || new Date().toISOString();
                
                const existingIndex = licenses.findIndex(l => l.id === license.id);
                if (existingIndex >= 0) {
                    licenses[existingIndex] = { ...licenses[existingIndex], ...license, updatedAt: new Date().toISOString() };
                } else {
                    licenses.push(license);
                }
                
                localStorage.setItem('licenses', JSON.stringify(licenses));
                this.addActivity(`License ${license.software} ${existingIndex >= 0 ? 'updated' : 'added'}`, 'license');
                return license;
            }

            deleteLicense(licenseId) {
                const licenses = this.getLicenses();
                const license = licenses.find(l => l.id === licenseId);
                const filtered = licenses.filter(l => l.id !== licenseId);
                localStorage.setItem('licenses', JSON.stringify(filtered));
                this.addActivity(`License ${license.software} deleted`, 'license');
            }

            // Activities
            getActivities() {
                return JSON.parse(localStorage.getItem('activities') || '[]');
            }

            addActivity(description, type) {
                const activities = this.getActivities();
                activities.unshift({
                    id: Date.now().toString(),
                    description,
                    type,
                    timestamp: new Date().toISOString()
                });
                
                if (activities.length > 50) {
                    activities.splice(50);
                }
                
                localStorage.setItem('activities', JSON.stringify(activities));
            }
        }

        // Initialize database
        const db = new DatabaseManager();

        // Global state
        let currentPage = 'dashboard';
        let currentUser = null;

        // Login/Register Functions
        function showRegisterForm() {
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('register-form').classList.remove('hidden');
        }

        function showLoginForm() {
            document.getElementById('register-form').classList.add('hidden');
            document.getElementById('login-form').classList.remove('hidden');
        }

        function handleLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            const users = db.getUsers();
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                showApp();
                showToast('Login successful!');
            } else {
                showToast('Invalid email or password', 'error');
            }
        }

        function handleRegister(event) {
            event.preventDefault();
            
            const user = {
                name: document.getElementById('register-name').value,
                email: document.getElementById('register-email').value,
                password: document.getElementById('register-password').value,
                role: document.getElementById('register-role').value,
                department: document.getElementById('register-department').value,
                status: 'Active',
                lastActive: new Date().toISOString()
            };
            
            db.saveUser(user);
            showToast('Registration successful! Please login.');
            showLoginForm();
        }

        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            showLogin();
            showToast('Logged out successfully');
        }

        function showLogin() {
            document.getElementById('login-page').classList.remove('hidden');
            document.getElementById('app').classList.add('hidden');
        }

        function showApp() {
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            
            // Update user info in header
            if (currentUser) {
                document.getElementById('user-name').textContent = currentUser.name;
                document.getElementById('user-initials').textContent = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
            }
            
            // Initialize dashboard
            updateDashboard();
            initDashboardCharts();
        }

        // Page navigation
        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            
            document.getElementById(pageName + '-page').classList.remove('hidden');
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('text-indigo-600');
                btn.classList.add('text-gray-700');
            });
            
            event.target.classList.remove('text-gray-700');
            event.target.classList.add('text-indigo-600');
            
            currentPage = pageName;
            
            if (pageName === 'dashboard') {
                updateDashboard();
                initDashboardCharts();
            } else if (pageName === 'assets') {
                loadAssets();
            } else if (pageName === 'licenses') {
                loadLicenses();
            }
            
            setTimeout(() => lucide.createIcons(), 100);
        }

        // Update Dashboard
        function updateDashboard() {
            const assets = db.getAssets();
            const licenses = db.getLicenses();
            const activities = db.getActivities();
            
            document.getElementById('total-assets').textContent = assets.length;
            document.getElementById('active-assets').textContent = assets.filter(a => a.status === 'Active').length;
            
            const utilizationRate = assets.length > 0 ? 
                Math.round((assets.filter(a => a.status === 'Active').length / assets.length) * 100) : 0;
            document.getElementById('utilization-rate').textContent = utilizationRate + '% utilization';
            
            document.getElementById('total-licenses').textContent = licenses.length;
            document.getElementById('active-licenses').textContent = licenses.filter(l => !l.expiryDate || new Date(l.expiryDate) > new Date()).length;
            document.getElementById('expiring-licenses').textContent = licenses.filter(l => {
                if (!l.expiryDate) return false;
                const expiryDate = new Date(l.expiryDate);
                const thirtyDaysFromNow = new Date();
                thirtyDaysFromNow.setDate(thirtyDaysFromNow.getDate() + 30);
                return expiryDate <= thirtyDaysFromNow && expiryDate > new Date();
            }).length;
            
            // Update recent activity
            const activityContainer = document.getElementById('recent-activity');
            activityContainer.innerHTML = '';
            
            activities.slice(0, 10).forEach(activity => {
                const activityEl = document.createElement('div');
                activityEl.className = 'flex items-center space-x-4 p-3 hover:bg-gray-50 rounded-lg';
                
                const iconClass = getActivityIcon(activity.type);
                const iconColor = getActivityColor(activity.type);
                const timeAgo = getTimeAgo(new Date(activity.timestamp));
                
                activityEl.innerHTML = `
                    <div class="w-10 h-10 ${iconColor} rounded-full flex items-center justify-center">
                        <i data-lucide="${iconClass}" class="w-5 h-5 text-white"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-medium">${activity.description}</p>
                        <p class="text-xs text-gray-500">${timeAgo}</p>
                    </div>
                `;
                
                activityContainer.appendChild(activityEl);
            });
            
            lucide.createIcons();
        }

        function getActivityIcon(type) {
            const icons = {
                'asset': 'package',
                'user': 'user',
                'license': 'shield',
                'system': 'settings'
            };
            return icons[type] || 'activity';
        }

        function getActivityColor(type) {
            const colors = {
                'asset': 'bg-green-100',
                'user': 'bg-blue-100',
                'license': 'bg-purple-100',
                'system': 'bg-gray-100'
            };
            return colors[type] || 'bg-gray-100';
        }

        function getTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            
            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return Math.floor(seconds / 60) + ' minutes ago';
            if (seconds < 86400) return Math.floor(seconds / 3600) + ' hours ago';
            return Math.floor(seconds / 86400) + ' days ago';
        }

        // Load Assets
        function loadAssets() {
            const assets = db.getAssets();
            const tbody = document.getElementById('assets-table-body');
            tbody.innerHTML = '';
            
            assets.forEach(asset => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                const statusClass = getStatusClass(asset.status);
                const iconClass = getCategoryIcon(asset.category);
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center mr-3">
                                <i data-lucide="${iconClass}" class="w-5 h-5 text-indigo-600"></i>
                            </div>
                            <div>
                                <div class="text-sm font-medium text-gray-900">${asset.name}</div>
                                <div class="text-sm text-gray-500">Asset #${asset.id}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${asset.category}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="status-badge ${statusClass}">${asset.status}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${asset.location}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Rp ${asset.value.toLocaleString('id-ID')}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatDate(asset.purchaseDate)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                        <button onclick="viewAsset('${asset.id}')" class="text-indigo-600 hover:text-indigo-900 mr-3">View</button>
                        <button onclick="editAsset('${asset.id}')" class="text-gray-600 hover:text-gray-900 mr-3">Edit</button>
                        <button onclick="deleteAsset('${asset.id}')" class="text-red-600 hover:text-red-900">Delete</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            lucide.createIcons();
        }

        // Load Licenses
        function loadLicenses() {
            const licenses = db.getLicenses();
            const tbody = document.getElementById('licenses-table-body');
            tbody.innerHTML = '';
            
            licenses.forEach(license => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                const statusClass = getLicenseStatusClass(license);
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${license.software}</div>
                        <div class="text-sm text-gray-500">${license.vendor || ''}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${license.licenseKey}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${license.type}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${license.seats}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${license.used || 0}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${license.expiryDate ? formatDate(license.expiryDate) : 'Perpetual'}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="status-badge ${statusClass}">${getLicenseStatusText(license)}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                        <button onclick="editLicense('${license.id}')" class="text-gray-600 hover:text-gray-900 mr-3">Edit</button>
                        <button onclick="deleteLicense('${license.id}')" class="text-red-600 hover:text-red-900">Delete</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            lucide.createIcons();
        }

        function getLicenseStatusClass(license) {
            if (!license.expiryDate) return 'bg-green-100 text-green-800';
            
            const expiryDate = new Date(license.expiryDate);
            const now = new Date();
            const thirtyDaysFromNow = new Date();
            thirtyDaysFromNow.setDate(thirtyDaysFromNow.getDate() + 30);
            
            if (expiryDate < now) return 'bg-red-100 text-red-800';
            if (expiryDate <= thirtyDaysFromNow) return 'bg-yellow-100 text-yellow-800';
            return 'bg-green-100 text-green-800';
        }

        function getLicenseStatusText(license) {
            if (!license.expiryDate) return 'Active';
            
            const expiryDate = new Date(license.expiryDate);
            const now = new Date();
            const thirtyDaysFromNow = new Date();
            thirtyDaysFromNow.setDate(thirtyDaysFromNow.getDate() + 30);
            
            if (expiryDate < now) return 'Expired';
            if (expiryDate <= thirtyDaysFromNow) return 'Expiring Soon';
            return 'Active';
        }

        function getStatusClass(status) {
            const classes = {
                'Active': 'bg-green-100 text-green-800',
                'Maintenance': 'bg-yellow-100 text-yellow-800',
                'Retired': 'bg-red-100 text-red-800'
            };
            return classes[status] || 'bg-gray-100 text-gray-800';
        }

        function getCategoryIcon(category) {
            const icons = {
                'Electronics': 'laptop',
                'Furniture': 'home',
                'Vehicle': 'car',
                'Equipment': 'tool'
            };
            return icons[category] || 'package';
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID');
        }

        // Asset Modal Functions
        function openAddAssetModal() {
            document.getElementById('asset-modal-title').textContent = 'Add New Asset';
            document.getElementById('asset-submit-btn').textContent = 'Save Asset';
            document.getElementById('asset-id').value = '';
            document.getElementById('add-asset-form').reset();
            document.getElementById('asset-purchase-date').valueAsDate = new Date();
            document.getElementById('add-asset-modal').classList.add('show');
        }

        function editAsset(assetId) {
            const asset = db.getAssets().find(a => a.id === assetId);
            if (asset) {
                document.getElementById('asset-modal-title').textContent = 'Edit Asset';
                document.getElementById('asset-submit-btn').textContent = 'Update Asset';
                document.getElementById('asset-id').value = asset.id;
                document.getElementById('asset-name').value = asset.name;
                document.getElementById('asset-category').value = asset.category;
                document.getElementById('asset-status').value = asset.status;
                document.getElementById('asset-location').value = asset.location;
                document.getElementById('asset-value').value = asset.value;
                document.getElementById('asset-purchase-date').value = asset.purchaseDate;
                document.getElementById('asset-description').value = asset.description || '';
                document.getElementById('add-asset-modal').classList.add('show');
            }
        }

        function saveAsset(event) {
            event.preventDefault();
            
            const assetId = document.getElementById('asset-id').value;
            const asset = {
                name: document.getElementById('asset-name').value,
                category: document.getElementById('asset-category').value,
                status: document.getElementById('asset-status').value,
                location: document.getElementById('asset-location').value,
                value: parseInt(document.getElementById('asset-value').value),
                purchaseDate: document.getElementById('asset-purchase-date').value,
                description: document.getElementById('asset-description').value
            };
            
            if (assetId) {
                asset.id = assetId;
                db.saveAsset(asset);
                showToast('Asset updated successfully');
            } else {
                db.saveAsset(asset);
                showToast('Asset saved successfully');
            }
            
            closeModal('add-asset-modal');
            loadAssets();
            if (currentPage === 'dashboard') updateDashboard();
        }

        function deleteAsset(assetId) {
            if (confirm('Are you sure you want to delete this asset?')) {
                db.deleteAsset(assetId);
                loadAssets();
                showToast('Asset deleted successfully');
                if (currentPage === 'dashboard') updateDashboard();
            }
        }

        function viewAsset(assetId) {
            const asset = db.getAssets().find(a => a.id === assetId);
            if (asset) {
                alert(`Asset Details:\n\nName: ${asset.name}\nCategory: ${asset.category}\nStatus: ${asset.status}\nLocation: ${asset.location}\nValue: Rp ${asset.value.toLocaleString('id-ID')}\nPurchase Date: ${formatDate(asset.purchaseDate)}\nDescription: ${asset.description || 'N/A'}`);
            }
        }

        // License Modal Functions
        function openAddLicenseModal() {
            document.getElementById('license-modal-title').textContent = 'Add New License';
            document.getElementById('license-submit-btn').textContent = 'Save License';
            document.getElementById('license-id').value = '';
            document.getElementById('add-license-form').reset();
            document.getElementById('add-license-modal').classList.add('show');
        }

        function editLicense(licenseId) {
            const license = db.getLicenses().find(l => l.id === licenseId);
            if (license) {
                document.getElementById('license-modal-title').textContent = 'Edit License';
                document.getElementById('license-submit-btn').textContent = 'Update License';
                document.getElementById('license-id').value = license.id;
                document.getElementById('license-software').value = license.software;
                document.getElementById('license-key').value = license.licenseKey;
                document.getElementById('license-type').value = license.type;
                document.getElementById('license-seats').value = license.seats;
                document.getElementById('license-used').value = license.used || 0;
                document.getElementById('license-expiry').value = license.expiryDate || '';
                document.getElementById('license-vendor').value = license.vendor || '';
                document.getElementById('license-description').value = license.description || '';
                document.getElementById('add-license-modal').classList.add('show');
            }
        }

        function saveLicense(event) {
            event.preventDefault();
            
            const licenseId = document.getElementById('license-id').value;
            const license = {
                software: document.getElementById('license-software').value,
                licenseKey: document.getElementById('license-key').value,
                type: document.getElementById('license-type').value,
                seats: parseInt(document.getElementById('license-seats').value),
                used: parseInt(document.getElementById('license-used').value) || 0,
                expiryDate: document.getElementById('license-expiry').value,
                vendor: document.getElementById('license-vendor').value,
                description: document.getElementById('license-description').value
            };
            
            if (licenseId) {
                license.id = licenseId;
                db.saveLicense(license);
                showToast('License updated successfully');
            } else {
                db.saveLicense(license);
                showToast('License saved successfully');
            }
            
            closeModal('add-license-modal');
            loadLicenses();
            if (currentPage === 'dashboard') updateDashboard();
        }

        function deleteLicense(licenseId) {
            if (confirm('Are you sure you want to delete this license?')) {
                db.deleteLicense(licenseId);
                loadLicenses();
                showToast('License deleted successfully');
                if (currentPage === 'dashboard') updateDashboard();
            }
        }

        // Filter Assets
        function filterAssets() {
            const searchTerm = document.getElementById('asset-search').value.toLowerCase();
            const categoryFilter = document.getElementById('category-filter').value;
            const statusFilter = document.getElementById('status-filter').value;
            
            const assets = db.getAssets();
            const filtered = assets.filter(asset => {
                const matchesSearch = asset.name.toLowerCase().includes(searchTerm) || 
                                     asset.id.toLowerCase().includes(searchTerm);
                const matchesCategory = !categoryFilter || asset.category === categoryFilter;
                const matchesStatus = !statusFilter || asset.status === statusFilter;
                
                return matchesSearch && matchesCategory && matchesStatus;
            });
            
            const tbody = document.getElementById('assets-table-body');
            tbody.innerHTML = '';
            
            filtered.forEach(asset => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                const statusClass = getStatusClass(asset.status);
                const iconClass = getCategoryIcon(asset.category);
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center mr-3">
                                <i data-lucide="${iconClass}" class="w-5 h-5 text-indigo-600"></i>
                            </div>
                            <div>
                                <div class="text-sm font-medium text-gray-900">${asset.name}</div>
                                <div class="text-sm text-gray-500">Asset #${asset.id}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${asset.category}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="status-badge ${statusClass}">${asset.status}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${asset.location}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Rp ${asset.value.toLocaleString('id-ID')}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatDate(asset.purchaseDate)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                        <button onclick="viewAsset('${asset.id}')" class="text-indigo-600 hover:text-indigo-900 mr-3">View</button>
                        <button onclick="editAsset('${asset.id}')" class="text-gray-600 hover:text-gray-900 mr-3">Edit</button>
                        <button onclick="deleteAsset('${asset.id}')" class="text-red-600 hover:text-red-900">Delete</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            lucide.createIcons();
        }

        // Export Assets
        function exportAssets() {
            const assets = db.getAssets();
            const csv = convertToCSV(assets);
            downloadCSV(csv, 'assets.csv');
            showToast('Assets exported successfully');
        }

        function convertToCSV(data) {
            const headers = ['ID', 'Name', 'Category', 'Status', 'Location', 'Value', 'Purchase Date', 'Description'];
            const csvContent = [
                headers.join(','),
                ...data.map(asset => [
                    asset.id,
                    `"${asset.name}"`,
                    asset.category,
                    asset.status,
                    `"${asset.location}"`,
                    asset.value,
                    asset.purchaseDate,
                    `"${asset.description || ''}"`
                ].join(','))
            ].join('\n');
            
            return csvContent;
        }

        function downloadCSV(csv, filename) {
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Modal Functions
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // Mobile Menu
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('show');
        }

        // Utility Functions
        function toggleDarkMode() {
            document.body.classList.toggle('dark');
        }

        function toggleNotifications() {
            // Placeholder for notifications
            showToast('No new notifications');
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            toastMessage.textContent = message;
            toast.style.background = type === 'error' ? '#ef4444' : '#10b981';
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Chart Functions
        function initDashboardCharts() {
            const assets = db.getAssets();
            
            // Asset Distribution Chart
            const assetCtx = document.getElementById('assetChart');
            if (assetCtx) {
                if (assetCtx.chart) {
                    assetCtx.chart.destroy();
                }
                
                const categoryCounts = {};
                assets.forEach(asset => {
                    categoryCounts[asset.category] = (categoryCounts[asset.category] || 0) + 1;
                });
                
                assetCtx.chart = new Chart(assetCtx, {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(categoryCounts),
                        datasets: [{
                            data: Object.values(categoryCounts),
                            backgroundColor: [
                                '#6366f1',
                                '#8b5cf6',
                                '#ec4899',
                                '#f59e0b'
                            ],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            // Maintenance Overview Chart
            const maintenanceCtx = document.getElementById('maintenanceChart');
            if (maintenanceCtx) {
                if (maintenanceCtx.chart) {
                    maintenanceCtx.chart.destroy();
                }
                
                const monthlyData = {
                    'Jan': { completed: 12, scheduled: 8 },
                    'Feb': { completed: 19, scheduled: 12 },
                    'Mar': { completed: 8, scheduled: 15 },
                    'Apr': { completed: 15, scheduled: 10 },
                    'May': { completed: 22, scheduled: 18 },
                    'Jun': { completed: 18, scheduled: 14 }
                };
                
                maintenanceCtx.chart = new Chart(maintenanceCtx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(monthlyData),
                        datasets: [{
                            label: 'Completed',
                            data: Object.values(monthlyData).map(d => d.completed),
                            backgroundColor: '#10b981'
                        }, {
                            label: 'Scheduled',
                            data: Object.values(monthlyData).map(d => d.scheduled),
                            backgroundColor: '#f59e0b'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        // Close modals when clicking outside
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('show');
            }
        });

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showApp();
            } else {
                showLogin();
            }
            
            lucide.createIcons();
        });
    </script>
</body>
</html>
